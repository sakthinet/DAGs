# TCS ECM Airflow DAG Crafter - Frontend Architecture Diagram

## ğŸ“ System Architecture Overview

```mermaid
graph TB
    %% User Layer
    User[ğŸ‘¤ User] --> Browser{ğŸŒ Browser}
    
    %% Frontend Application Layer
    Browser --> React[âš›ï¸ React Frontend Application]
    
    %% Main Application Components
    React --> Router[ğŸ”€ React Router]
    Router --> MainApp[ğŸ“± Main App Container]
    
    %% Core Pages & Components
    MainApp --> Dashboard[ğŸ“Š DAG Dashboard]
    MainApp --> Reports[ğŸ“ˆ Reports & Analytics]
    MainApp --> Upload[ğŸ“‚ File Upload Studio]
    MainApp --> Configure[âš™ï¸ Workflow Configuration]
    MainApp --> Generate[ğŸ› ï¸ Pipeline Builder]
    MainApp --> XMLViewer[ğŸ“„ XML Data Viewer]
    
    %% Global Components
    React --> Sidebar[ğŸ“‹ Navigation Sidebar]
    React --> Chatbot[ğŸ¤– AI Assistant (Buddy)]
    React --> ThemeSelector[ğŸ¨ Theme Customization]
    React --> StatusBar[ğŸ“¡ Connection Monitor]
    
    %% State Management & Context
    React --> ThemeContext[ğŸ¨ Theme Context]
    React --> QueryClient[ğŸ“¦ React Query Client]
    React --> ToastContext[ğŸ’¬ Toast Notifications]
    
    %% API Layer & Hooks
    React --> APIHooks[ğŸ”— Custom Hooks]
    APIHooks --> AirflowAPI[ğŸ”Œ Airflow API Hook]
    APIHooks --> ToastHook[ğŸ’¬ Toast Hook]
    APIHooks --> MobileHook[ğŸ“± Mobile Hook]
    
    %% Backend Communication
    AirflowAPI --> BackendAPI[ğŸŒ Backend API Server]
    BackendAPI --> APIRoutes[ğŸ›¤ï¸ Express Routes]
    
    %% API Endpoints
    APIRoutes --> UploadAPI[ğŸ“¤ /api/upload-csv]
    APIRoutes --> GenerateAPI[âš™ï¸ /api/generate-dag]
    APIRoutes --> SaveAPI[ğŸ’¾ /api/save-dag]
    APIRoutes --> TestAPI[ğŸ§ª /api/test-dag]
    APIRoutes --> ValidateAPI[âœ… /api/validate-deployment]
    APIRoutes --> ReportsAPI[ğŸ“Š /api/reports]
    APIRoutes --> ChatbotAPI[ğŸ¤– /api/chatbot/query]
    APIRoutes --> CacheAPI[ğŸ—„ï¸ /api/cache/clear]
    
    %% External Services
    BackendAPI --> AirflowServer[ğŸš€ Apache Airflow Server]
    BackendAPI --> FileSystem[ğŸ“ Local File System]
    BackendAPI --> Storage[ğŸ’¾ Local Storage/Database]
    
    %% Airflow Integration
    AirflowServer --> AirflowWebUI[ğŸŒ Airflow Web UI]
    AirflowServer --> AirflowAPI2[ğŸ”— Airflow REST API v2]
    AirflowServer --> AirflowDAGs[ğŸ“Š DAG Repository]
    AirflowServer --> AirflowScheduler[â° Airflow Scheduler]
    
    %% File Management
    FileSystem --> UploadsDir[ğŸ“ uploads/]
    FileSystem --> DataDir[ğŸ“ data/]
    FileSystem --> DAGsDir[ğŸ“ dags/]
    FileSystem --> ReportsDir[ğŸ“ reports/]
    
    %% AI Services
    ChatbotAPI --> OllamaLLM[ğŸ§  Ollama Local LLM]
    ChatbotAPI --> FallbackLLM[ğŸ¤– Fallback LLM Service]
    ChatbotAPI --> RuleEngine[ğŸ“‹ Rule-based Responses]
    
    %% Styling & Theming
    React --> TailwindCSS[ğŸ¨ Tailwind CSS]
    React --> ShadcnUI[ğŸ­ Shadcn/UI Components]
    React --> LucideIcons[ğŸ¯ Lucide Icons]
    
    %% Build & Development
    React --> Vite[âš¡ Vite Build Tool]
    React --> TypeScript[ğŸ“˜ TypeScript]
    
    %% Color coding for different layers
    classDef userLayer fill:#e1f5fe
    classDef frontendLayer fill:#f3e5f5
    classDef apiLayer fill:#e8f5e8
    classDef backendLayer fill:#fff3e0
    classDef externalLayer fill:#fce4ec
    classDef storageLayer fill:#f1f8e9
    
    class User,Browser userLayer
    class React,Router,MainApp,Dashboard,Reports,Upload,Configure,Generate,XMLViewer,Sidebar,Chatbot,ThemeSelector,StatusBar frontendLayer
    class APIHooks,AirflowAPI,BackendAPI,APIRoutes,UploadAPI,GenerateAPI,SaveAPI,TestAPI,ValidateAPI,ReportsAPI,ChatbotAPI,CacheAPI apiLayer
    class AirflowServer,AirflowWebUI,AirflowAPI2,AirflowScheduler backendLayer
    class OllamaLLM,FallbackLLM,RuleEngine externalLayer
    class FileSystem,Storage,UploadsDir,DataDir,DAGsDir,ReportsDir,AirflowDAGs storageLayer
```

## ğŸ”„ Data Flow Architecture

```mermaid
sequenceDiagram
    participant U as ğŸ‘¤ User
    participant F as âš›ï¸ Frontend
    participant A as ğŸ”— API Layer
    participant B as ğŸŒ Backend
    participant AF as ğŸš€ Airflow
    participant FS as ğŸ“ File System
    participant AI as ğŸ¤– AI Assistant
    
    %% File Upload Flow
    Note over U,AI: ğŸ“¤ File Upload & Processing Workflow
    U->>F: Upload CSV File
    F->>A: POST /api/upload-csv
    A->>B: Process & Validate File
    B->>FS: Save to uploads/
    FS-->>B: File Saved
    B-->>A: Upload Response
    A-->>F: File Details
    F-->>U: Preview Data
    
    %% DAG Generation Flow
    Note over U,AI: âš™ï¸ DAG Generation & Deployment
    U->>F: Configure DAG Settings
    F->>A: POST /api/generate-dag
    A->>B: Generate Script
    B->>FS: Create DAG File
    FS-->>B: File Created
    B-->>A: Generated Script
    A-->>F: DAG Code
    F-->>U: Display Code Editor
    
    %% Airflow Integration
    Note over U,AI: ğŸš€ Airflow Deployment & Monitoring
    U->>F: Deploy to Airflow
    F->>A: POST /api/save-dag
    A->>B: Deploy DAG
    B->>AF: Copy to DAGs Directory
    AF-->>B: DAG Loaded
    B->>AF: Test Connection
    AF-->>B: Status Response
    B-->>A: Deployment Status
    A-->>F: Success/Error
    F-->>U: Notification
    
    %% Real-time Monitoring
    Note over U,AI: ğŸ“Š Real-time Dashboard Updates
    F->>A: GET Airflow Status
    A->>AF: Query DAG Stats
    AF-->>A: DAG Information
    A-->>F: Dashboard Data
    F-->>U: Live Updates
    
    %% AI Assistant Interaction
    Note over U,AI: ğŸ¤– AI-Powered Assistance
    U->>F: Ask Question
    F->>A: POST /api/chatbot/query
    A->>AI: Process Query
    AI->>AI: Analyze Context
    AI-->>A: Generated Response
    A-->>F: Assistant Reply
    F-->>U: AI Guidance
    
    %% Reports & Analytics
    Note over U,AI: ğŸ“ˆ Business Intelligence
    U->>F: View Reports
    F->>A: GET /api/reports
    A->>FS: Read Report Files
    FS-->>A: Report Data
    A-->>F: Analytics Data
    F-->>U: Interactive Charts
```

## ğŸ—ï¸ Component Architecture

```mermaid
graph LR
    %% Main Application Structure
    subgraph "ğŸ–¥ï¸ Frontend Application"
        subgraph "ğŸ“± Core Pages"
            Dashboard[ğŸ“Š Dashboard]
            Reports[ğŸ“ˆ Reports]
            Upload[ğŸ“‚ Upload]
            Configure[âš™ï¸ Configure]
            Generate[ğŸ› ï¸ Generate]
            XMLView[ğŸ“„ XML Viewer]
        end
        
        subgraph "ğŸ§© Shared Components"
            Sidebar[ğŸ“‹ Sidebar]
            Header[ğŸ“„ Header]
            StatusBar[ğŸ“¡ Status]
            ThemeUI[ğŸ¨ Theme UI]
        end
        
        subgraph "ğŸ¤– AI Features"
            Chatbot[ğŸ’¬ Chatbot]
            Suggestions[ğŸ’¡ Suggestions]
            Context[ğŸ§  Context Analysis]
        end
    end
    
    subgraph "ğŸ”— API Integration"
        subgraph "ğŸ“¡ Communication Layer"
            APIClient[ğŸŒ API Client]
            AirflowHook[ğŸ”Œ Airflow Hook]
            QueryCache[ğŸ“¦ Query Cache]
        end
        
        subgraph "ğŸ›¤ï¸ Backend Routes"
            FileAPI[ğŸ“¤ File APIs]
            DAGAPI[âš™ï¸ DAG APIs]
            MonitorAPI[ğŸ“Š Monitor APIs]
            ChatAPI[ğŸ¤– Chat APIs]
        end
    end
    
    subgraph "ğŸ—„ï¸ Data Layer"
        subgraph "ğŸ’¾ Storage"
            LocalFiles[ğŸ“ Local Files]
            Cache[ğŸ—„ï¸ Cache]
            Reports2[ğŸ“Š Reports Data]
        end
        
        subgraph "ğŸš€ Airflow"
            WebUI[ğŸŒ Web UI]
            RESTAPI[ğŸ”— REST API]
            Scheduler[â° Scheduler]
            DAGRepo[ğŸ“Š DAG Repository]
        end
    end
    
    %% Connections
    Dashboard --> APIClient
    Reports --> APIClient
    Upload --> APIClient
    Configure --> APIClient
    Generate --> APIClient
    XMLView --> APIClient
    
    Chatbot --> ChatAPI
    StatusBar --> MonitorAPI
    
    APIClient --> FileAPI
    APIClient --> DAGAPI
    APIClient --> MonitorAPI
    
    AirflowHook --> RESTAPI
    FileAPI --> LocalFiles
    DAGAPI --> DAGRepo
    MonitorAPI --> WebUI
    
    %% Styling
    classDef frontend fill:#e3f2fd
    classDef api fill:#e8f5e8
    classDef storage fill:#fff3e0
    classDef airflow fill:#fce4ec
    
    class Dashboard,Reports,Upload,Configure,Generate,XMLView,Sidebar,Header,StatusBar,ThemeUI,Chatbot,Suggestions,Context frontend
    class APIClient,AirflowHook,QueryCache,FileAPI,DAGAPI,MonitorAPI,ChatAPI api
    class LocalFiles,Cache,Reports2 storage
    class WebUI,RESTAPI,Scheduler,DAGRepo airflow
```

## ğŸ”Œ Technology Stack

```mermaid
mindmap
  root((ğŸ—ï¸ TCS ECM<br/>Architecture))
    ğŸ–¥ï¸ Frontend
      âš›ï¸ React 18
        ğŸ”€ Wouter Router
        ğŸ“¦ React Query
        ğŸ¨ Tailwind CSS
        ğŸ­ Shadcn/UI
        ğŸ¯ Lucide Icons
      ğŸ“˜ TypeScript
      âš¡ Vite
      ğŸ¨ Theme System
        ğŸŒ™ Dark/Light Mode
        ğŸ¨ Custom Themes
        ğŸ’¾ Local Storage
    ğŸŒ Backend
      ğŸŸ¢ Node.js
      ğŸ“Š Express.js
      ğŸ“¤ Multer Upload
      ğŸ—„ï¸ Simple Cache
      ğŸ“ File System API
      ğŸ” CORS Enabled
    ğŸš€ Airflow Integration
      ğŸ”— REST API v2
      ğŸ“Š DAG Management
      â° Scheduler
      ğŸŒ Web UI Access
      ğŸ“ˆ Monitoring
    ğŸ¤– AI Features
      ğŸ§  Ollama Local LLM
      ğŸ¤– Fallback Services
      ğŸ“‹ Rule Engine
      ğŸ’¬ Context Awareness
      ğŸ’¡ Smart Suggestions
    ğŸ“Š Data & Storage
      ğŸ“ Local File System
        ğŸ“¤ uploads/
        ğŸ“Š dags/
        ğŸ“ˆ reports/
        ğŸ’¾ data/
      ğŸ—„ï¸ In-Memory Cache
      ğŸ“‹ JSON Configuration
```

This comprehensive architecture diagram shows:

1. **User Interface Layer** - React-based frontend with multiple specialized pages
2. **API Communication** - RESTful APIs connecting frontend to backend services
3. **Backend Services** - Express.js server handling file processing, DAG generation, and Airflow integration
4. **External Integrations** - Apache Airflow server and AI services
5. **Data Flow** - Complete workflow from file upload to DAG deployment and monitoring
6. **Technology Stack** - Modern web technologies with robust data processing capabilities

The architecture demonstrates a well-structured separation of concerns with clear communication patterns and comprehensive functionality for enterprise workflow automation.
